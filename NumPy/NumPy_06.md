
# NumPy

참고 : 파이썬 데이터 싸이언스 핸드북 98p-105p


```python
import numpy as np
```

### 배열 정렬

> .sort() <br>
> .argsort()


```python
x = np.array([2,1,4,3,5])
np.sort(x) # 입력값이 수정되지 않는다.
```




    array([1, 2, 3, 4, 5])




```python
x.sort() # 입력값이 정렬상태로 수정된다.
x
```




    array([1, 2, 3, 4, 5])




```python
x = np.array([2,1,4,3,5])
i = np.argsort(x) # 정렬된 요소의 인덱스 반환
i
```




    array([1, 0, 3, 2, 4], dtype=int64)




```python
x[i]
```




    array([1, 2, 3, 4, 5])



행이나 열 기준으로 정렬하기


```python
rand = np.random.RandomState(42)
X = rand.randint(0,10,(4,6))
X
```




    array([[6, 3, 7, 4, 6, 9],
           [2, 6, 7, 4, 3, 7],
           [7, 2, 5, 4, 1, 7],
           [5, 1, 4, 0, 9, 5]])




```python
np.sort(X, axis=0) # 각 열 정렬
```




    array([[2, 1, 4, 0, 1, 5],
           [5, 2, 5, 4, 3, 7],
           [6, 3, 7, 4, 6, 7],
           [7, 6, 7, 4, 9, 9]])




```python
np.sort(X, axis=1) # 각 행 정렬
```




    array([[3, 4, 6, 6, 7, 9],
           [2, 3, 4, 6, 7, 7],
           [1, 2, 4, 5, 7, 7],
           [0, 1, 4, 5, 5, 9]])



### 부분 정렬 : 파티션 나누기

> .partition()


```python
x = np.array([7,2,3,1,6,5,4])
np.partition(x, 3) # 가장 작은 3개의 값이 앞에 나온다.
```




    array([2, 1, 3, 4, 6, 5, 7])




```python
np.partition(X, 2, axis=1)
```




    array([[3, 4, 6, 7, 6, 9],
           [2, 3, 4, 7, 6, 7],
           [1, 2, 4, 5, 7, 7],
           [0, 1, 4, 5, 9, 5]])



### 예제 : K 최근접 이웃 알고리즘


```python
X = rand.rand(10,2)
```


```python
% matplotlib inline
import matplotlib.pyplot as plt
import seaborn; seaborn.set()
plt.scatter(X[:,0], X[:,1], s=100)
```




    <matplotlib.collections.PathCollection at 0x169d048d588>




![png](output_19_1.png)



```python
dist_sq = np.sum((X[:,np.newaxis,:] - X[np.newaxis,:,:]) ** 2, axis=-1)
dist_sq
```




    array([[0.        , 0.40999909, 0.90538547, 0.05550496, 0.50287983,
            1.14976739, 1.15936537, 0.19672877, 1.16632222, 0.14319923],
           [0.40999909, 0.        , 0.55794316, 0.18090431, 0.00906581,
            0.21465798, 0.19098635, 0.15497331, 0.20095384, 0.16679585],
           [0.90538547, 0.55794316, 0.        , 0.81458763, 0.67649219,
            1.13419594, 0.74752753, 1.08562368, 0.9704683 , 1.03211241],
           [0.05550496, 0.18090431, 0.81458763, 0.        , 0.23387834,
            0.70468321, 0.74108843, 0.05338715, 0.72671958, 0.0288717 ],
           [0.50287983, 0.00906581, 0.67649219, 0.23387834, 0.        ,
            0.14021843, 0.1470605 , 0.16449241, 0.13755476, 0.18859392],
           [1.14976739, 0.21465798, 1.13419594, 0.70468321, 0.14021843,
            0.        , 0.06080186, 0.48946337, 0.01100053, 0.56059965],
           [1.15936537, 0.19098635, 0.74752753, 0.74108843, 0.1470605 ,
            0.06080186, 0.        , 0.61258786, 0.02046045, 0.66652228],
           [0.19672877, 0.15497331, 1.08562368, 0.05338715, 0.16449241,
            0.48946337, 0.61258786, 0.        , 0.54429694, 0.00424306],
           [1.16632222, 0.20095384, 0.9704683 , 0.72671958, 0.13755476,
            0.01100053, 0.02046045, 0.54429694, 0.        , 0.60957115],
           [0.14319923, 0.16679585, 1.03211241, 0.0288717 , 0.18859392,
            0.56059965, 0.66652228, 0.00424306, 0.60957115, 0.        ]])




```python
differences = X[:,np.newaxis,:] - X[np.newaxis,:,:]
differences.shape
```




    (10, 10, 2)




```python
sq_differences = differences ** 2
sq_differences.shape
```




    (10, 10, 2)




```python
dist_sq = sq_differences.sum(-1)
dist_sq.shape
```




    (10, 10)




```python
dist_sq.diagonal()
```




    array([0., 0., 0., 0., 0., 0., 0., 0., 0., 0.])




```python
nearest = np.argsort(dist_sq, axis=1)
nearest
```




    array([[0, 3, 9, 7, 1, 4, 2, 5, 6, 8],
           [1, 4, 7, 9, 3, 6, 8, 5, 0, 2],
           [2, 1, 4, 6, 3, 0, 8, 9, 7, 5],
           [3, 9, 7, 0, 1, 4, 5, 8, 6, 2],
           [4, 1, 8, 5, 6, 7, 9, 3, 0, 2],
           [5, 8, 6, 4, 1, 7, 9, 3, 2, 0],
           [6, 8, 5, 4, 1, 7, 9, 3, 2, 0],
           [7, 9, 3, 1, 4, 0, 5, 8, 6, 2],
           [8, 5, 6, 4, 1, 7, 9, 3, 2, 0],
           [9, 7, 3, 0, 1, 4, 5, 8, 6, 2]], dtype=int64)




```python
K = 2
nearest_partition = np.argpartition(dist_sq, K+1, axis=1)

plt.scatter(X[:,0], X[:,1], s=100)

k=2
for i in range(X.shape[0]):
    for j in nearest_partition[i, :K+1]:
        plt.plot(*zip(X[j], X[i]), color='black')
```


![png](output_26_0.png)

